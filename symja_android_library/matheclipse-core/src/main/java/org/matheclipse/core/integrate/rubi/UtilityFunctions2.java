package org.matheclipse.core.integrate.rubi;


import static org.matheclipse.core.expression.F.*;
import static org.matheclipse.core.integrate.rubi.UtilityFunctionCtors.*;
import static org.matheclipse.core.integrate.rubi.UtilityFunctions.*;

import org.matheclipse.core.interfaces.IAST;
import org.matheclipse.core.interfaces.IExpr;
import org.matheclipse.core.interfaces.ISymbol;
/** 
 * UtilityFunctions rules from the <a href="http://www.apmaths.uwo.ca/~arich/">Rubi -
 * rule-based integrator</a>.
 *  
 */
public class UtilityFunctions2 { 
  public static IAST RULES = List( 
SetDelayed(TrigSimplifyAux(Times(Power(Cot(v_),$p(n,true)),Power(Plus(Times(Power(Csc(v_),$p(n,true)),$p(b,true)),a_),CN1),$p(u,true))),
    Condition(Times(u,Times(Power(Cos(v),n),Power(Plus(b,Times(a,Power(Sin(v),n))),CN1))),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Cos(v_),$p(n,true)),$p(a,true)),Times(Power(Sin(v_),$p(n,true)),$p(b,true))),p_),Power(Sin(v_),$p(m,true)))),
    Condition(Power(Plus(b,Times(a,Power(Cot(v),n))),p),And(And(And(IntIntegerQ(List(m,n,p)),Greater(n,C0)),Less(p,C0)),Equal(m,Times(Times(CN1,n),p))))),
SetDelayed(TrigSimplifyAux(Times(Power(Cos(v_),$p(m,true)),Power(Plus(Times(Power(Cos(v_),$p(n,true)),$p(a,true)),Times(Power(Sin(v_),$p(n,true)),$p(b,true))),p_))),
    Condition(Power(Plus(a,Times(b,Power(Tan(v),n))),p),And(And(And(IntIntegerQ(List(m,n,p)),Greater(n,C0)),Less(p,C0)),Equal(m,Times(Times(CN1,n),p))))),
SetDelayed(TrigSimplifyAux(Power(Plus(Times(Cos(v_),$p(a,true)),Times(Sin(v_),$p(b,true))),n_)),
    Condition(Power(Plus(Times(Cos(v),Power(a,CN1)),Times(Sin(v),Power(b,CN1))),Times(CN1,n)),And(And(IntIntegerQ(n),Less(n,C0)),ZeroQ(Plus(Power(a,C2),Power(b,C2)))))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Cosh(z_),C2),$p(u,true)),Times(Power(Sinh(z_),C2),$p(v,true)),$p(w,true))),
    Condition(Plus(u,w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Sech(z_),C2),$p(u,true)),Times(Power(Tanh(z_),C2),$p(v,true)),$p(w,true))),
    Condition(Plus(u,w),SameQ(u,v))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Coth(z_),C2),$p(u,true)),Times(Power(Csch(z_),C2),$p(v,true)),$p(w,true))),
    Condition(Plus(u,w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Sinh(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(u,Power(Cosh(z),C2)),w),SameQ(u,v))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Cosh(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(v,Power(Sinh(z),C2)),w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Tanh(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(u,Power(Sech(z),C2)),w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Coth(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(v,Power(Csch(z),C2)),w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Sech(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(u,Power(Tanh(z),C2)),w),SameQ(u,Times(CN1,v)))),
SetDelayed(TrigSimplifyAux(Plus(Times(Power(Csch(z_),C2),$p(v,true)),u_,$p(w,true))),
    Condition(Plus(Times(u,Power(Coth(z),C2)),w),SameQ(u,v))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Cosh(v_),$p(b,true)),a_),CN1),Power(Sinh(v_),C2),$p(u,true))),
    Condition(Times(u,Plus(Times(CN1,Power(a,CN1)),Times(Cosh(v),Power(b,CN1)))),ZeroQ(Plus(Power(a,C2),Times(CN1,Power(b,C2)))))),
SetDelayed(TrigSimplifyAux(Times(Power(Cosh(v_),C2),Power(Plus(Times(Sinh(v_),$p(b,true)),a_),CN1),$p(u,true))),
    Condition(Times(u,Plus(Times(C1,Power(a,CN1)),Times(Sinh(v),Power(b,CN1)))),ZeroQ(Plus(Power(a,C2),Power(b,C2))))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Tanh(v_),$p(n,true)),$p(b,true)),a_),CN1),Power(Tanh(v_),$p(n,true)),$p(u,true))),
    Condition(Times(u,Power(Plus(b,Times(a,Power(Coth(v),n))),CN1)),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Coth(v_),$p(n,true)),Power(Plus(Times(Power(Coth(v_),$p(n,true)),$p(b,true)),a_),CN1),$p(u,true))),
    Condition(Times(u,Power(Plus(b,Times(a,Power(Tanh(v),n))),CN1)),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Sech(v_),$p(n,true)),$p(b,true)),a_),CN1),Power(Sech(v_),$p(n,true)),$p(u,true))),
    Condition(Times(u,Power(Plus(b,Times(a,Power(Cosh(v),n))),CN1)),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Csch(v_),$p(n,true)),Power(Plus(Times(Power(Csch(v_),$p(n,true)),$p(b,true)),a_),CN1),$p(u,true))),
    Condition(Times(u,Power(Plus(b,Times(a,Power(Sinh(v),n))),CN1)),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Power(Plus(Times(Csch(v_),$p(a,true)),Times(Coth(v_),$p(b,true))),n_)),
    Condition(Times(Power(a,n),Power(Coth(Times(v,C1D2)),n)),And(EvenQ(n),ZeroQ(Plus(a,Times(CN1,b)))))),
SetDelayed(TrigSimplifyAux(Power(Plus(Times(Csch(v_),$p(a,true)),Times(Coth(v_),$p(b,true))),n_)),
    Condition(Times(Power(b,n),Power(Tanh(Times(v,C1D2)),n)),And(EvenQ(n),ZeroQ(Plus(a,b))))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Coth(v_),$p(n,true)),$p(b,true)),$p(a,true)),$p(p,true)),Power(Sinh(v_),$p(m,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Sinh(v),Plus(m,Times(CN1,Times(n,p))))),Power(Plus(Times(b,Power(Cosh(v),n)),Times(a,Power(Sinh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Cosh(v_),$p(m,true)),Power(Plus(Times(Power(Tanh(v_),$p(n,true)),$p(b,true)),$p(a,true)),$p(p,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Cosh(v),Plus(m,Times(CN1,Times(n,p))))),Power(Plus(Times(b,Power(Sinh(v),n)),Times(a,Power(Cosh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Tanh(v_),C2),$p(b,true)),$p(a,true)),$p(p,true)),Power(Sech(v_),$p(m,true)),u_)),
    Condition(Times(u,Power(Plus(Times(b,Power(Sinh(v),C2)),Times(a,Power(Cosh(v),C2))),p)),And(IntIntegerQ(List(m,p)),Equal(Plus(m,Times(C2,p)),C0)))),
SetDelayed(TrigSimplifyAux(Times(Power(Csch(v_),$p(m,true)),Power(Plus(Times(Power(Coth(v_),C2),$p(b,true)),$p(a,true)),$p(p,true)),u_)),
    Condition(Times(u,Power(Plus(Times(b,Power(Cosh(v),C2)),Times(a,Power(Sinh(v),C2))),p)),And(IntIntegerQ(List(m,p)),Equal(Plus(m,Times(C2,p)),C0)))),
SetDelayed(TrigSimplifyAux(Times(Power(Cosh(v_),$p(m,true)),Power(Plus(Times(Power(Tanh(v_),$p(n,true)),$p(b,true)),Times(Power(Sech(v_),$p(n,true)),$p(c,true)),$p(a,true)),$p(p,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Cosh(v),Plus(m,Times(CN1,Times(n,p))))),Power(Plus(Plus(c,Times(b,Power(Sinh(v),n))),Times(a,Power(Cosh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Tanh(v_),$p(n,true)),$p(b,true)),Times(Power(Sech(v_),$p(n,true)),$p(c,true)),$p(a,true)),$p(p,true)),Power(Sech(v_),$p(m,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Sech(v),Plus(m,Times(n,p)))),Power(Plus(Plus(c,Times(b,Power(Sinh(v),n))),Times(a,Power(Cosh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Coth(v_),$p(n,true)),$p(b,true)),Times(Power(Csch(v_),$p(n,true)),$p(c,true)),$p(a,true)),$p(p,true)),Power(Sinh(v_),$p(m,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Sinh(v),Plus(m,Times(CN1,Times(n,p))))),Power(Plus(Plus(c,Times(b,Power(Cosh(v),n))),Times(a,Power(Sinh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Csch(v_),$p(m,true)),Power(Plus(Times(Power(Coth(v_),$p(n,true)),$p(b,true)),Times(Power(Csch(v_),$p(n,true)),$p(c,true)),$p(a,true)),$p(p,true)),$p(u,true))),
    Condition(Times(Times(u,Power(Csch(v),Plus(m,Times(n,p)))),Power(Plus(Plus(c,Times(b,Power(Cosh(v),n))),Times(a,Power(Sinh(v),n))),p)),IntIntegerQ(List(m,n,p)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Sech(v_),$p(n,true)),$p(b,true)),a_),CN1),Power(Tanh(v_),$p(n,true)),$p(u,true))),
    Condition(Times(u,Times(Power(Sinh(v),n),Power(Plus(b,Times(a,Power(Cosh(v),n))),CN1))),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Coth(v_),$p(n,true)),Power(Plus(Times(Power(Csch(v_),$p(n,true)),$p(b,true)),a_),CN1),$p(u,true))),
    Condition(Times(u,Times(Power(Cosh(v),n),Power(Plus(b,Times(a,Power(Sinh(v),n))),CN1))),And(And(IntIntegerQ(n),Greater(n,C0)),NonsumQ(a)))),
SetDelayed(TrigSimplifyAux(Times(Power(Plus(Times(Power(Cosh(v_),$p(n,true)),$p(a,true)),Times(Power(Sinh(v_),$p(n,true)),$p(b,true))),p_),Power(Sinh(v_),$p(m,true)))),
    Condition(Power(Plus(b,Times(a,Power(Coth(v),n))),p),And(And(And(IntIntegerQ(List(m,n,p)),Greater(n,C0)),Less(p,C0)),Equal(m,Times(Times(CN1,n),p))))),
SetDelayed(TrigSimplifyAux(Times(Power(Cosh(v_),$p(m,true)),Power(Plus(Times(Power(Cosh(v_),$p(n,true)),$p(a,true)),Times(Power(Sinh(v_),$p(n,true)),$p(b,true))),p_))),
    Condition(Power(Plus(a,Times(b,Power(Tanh(v),n))),p),And(And(And(IntIntegerQ(List(m,n,p)),Greater(n,C0)),Less(p,C0)),Equal(m,Times(Times(CN1,n),p))))),
SetDelayed(TrigSimplifyAux(Power(Plus(Times(Cosh(v_),$p(a,true)),Times(Sinh(v_),$p(b,true))),n_)),
    Condition(Power(Plus(Times(Cosh(v),Power(a,CN1)),Times(CN1,Times(Sinh(v),Power(b,CN1)))),Times(CN1,n)),And(And(IntIntegerQ(n),Less(n,C0)),ZeroQ(Plus(Power(a,C2),Times(CN1,Power(b,C2))))))),
SetDelayed(TrigSimplifyAux(u_),
    u),
SetDelayed(SmartTrigExpand(Times(Sec(u_),Sin(Times(n_,u_))),$p(x,SymbolHead)),
    Condition(Sum(Times(Times(Power(CN1,Plus(k,Times(n,C1D2))),C2),Sin(Times(Plus(Times(C2,k),Times(CN1,C1)),u))),List(k,C1,Times(n,C1D2))),And(And(EvenQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Sec(u_),Sin(Times(n_,u_))),$p(x,SymbolHead)),
    Condition(Plus(Times(Power(CN1,Times(Plus(n,Times(CN1,C1)),C1D2)),Tan(u)),Sum(Times(Times(Power(CN1,Plus(k,Times(Plus(n,Times(CN1,C1)),C1D2))),C2),Sin(Times(Times(C2,k),u))),List(k,C1,Times(Plus(n,Times(CN1,C1)),C1D2)))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cos(Times(n_,u_)),Csc(u_)),$p(x,SymbolHead)),
    Condition(Plus(Csc(u),Times(CN1,Sum(Times(C2,Sin(Times(Plus(Times(C2,k),Times(CN1,C1)),u))),List(k,C1,Times(n,C1D2))))),And(And(EvenQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cos(Times(n_,u_)),Csc(u_)),$p(x,SymbolHead)),
    Condition(Plus(Cot(u),Times(CN1,Sum(Times(C2,Sin(Times(Times(C2,k),u))),List(k,C1,Times(Plus(n,Times(CN1,C1)),C1D2))))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Sech(u_),Sinh(Times(n_,u_))),$p(x,SymbolHead)),
    Condition(Sum(Times(Times(Power(CN1,Plus(k,Times(n,C1D2))),C2),Sinh(Times(Plus(Times(C2,k),Times(CN1,C1)),u))),List(k,C1,Times(n,C1D2))),And(And(EvenQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Sech(u_),Sinh(Times(n_,u_))),$p(x,SymbolHead)),
    Condition(Plus(Times(Power(CN1,Times(Plus(n,Times(CN1,C1)),C1D2)),Tanh(u)),Sum(Times(Times(Power(CN1,Plus(k,Times(Plus(n,Times(CN1,C1)),C1D2))),C2),Sinh(Times(Times(C2,k),u))),List(k,C1,Times(Plus(n,Times(CN1,C1)),C1D2)))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cosh(Times(n_,u_)),Csch(u_)),$p(x,SymbolHead)),
    Condition(Plus(Csch(u),Sum(Times(C2,Sinh(Times(Plus(Times(C2,k),Times(CN1,C1)),u))),List(k,C1,Times(n,C1D2)))),And(And(EvenQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cosh(Times(n_,u_)),Csch(u_)),$p(x,SymbolHead)),
    Condition(Plus(Coth(u),Sum(Times(C2,Sinh(Times(Times(C2,k),u))),List(k,C1,Times(Plus(n,Times(CN1,C1)),C1D2)))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cosh(Times(n_,u_)),Power(Csch(u_),C2)),$p(x,SymbolHead)),
    Condition(Plus(Plus(n,Power(Csch(u),C2)),Sum(Times(Times(C4,Plus(Times(n,C1D2),Times(CN1,k))),Cosh(Times(Times(C2,k),u))),List(k,C1,Times(n,C1D2)))),And(And(EvenQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cosh(Times(n_,u_)),Power(Csch(u_),C2)),$p(x,SymbolHead)),
    Condition(Plus(Times(Coth(u),Csch(u)),Sum(Times(Times(C4,Plus(Times(Plus(n,C1),C1D2),Times(CN1,k))),Cosh(Times(Plus(Times(C2,k),Times(CN1,C1)),u))),List(k,C1,Times(Plus(n,C1),C1D2)))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Times(Cosh(Times(n_,u_)),Power(Csch(u_),C3)),$p(x,SymbolHead)),
    Condition(Plus(Plus(Times(Plus(Power(n,C2),Times(CN1,C1)),Times(Coth(u),C1D2)),Times(Coth(u),Power(Csch(u),C2))),Sum(Times(Times(integer(8L),Binomial(Plus(Times(Plus(n,C1),C1D2),Times(CN1,k)),C2)),Sinh(Times(Times(C2,k),u))),List(k,C1,Times(Plus(n,Times(CN1,C3)),C1D2)))),And(And(OddQ(n),Greater(n,C1)),Not(FreeQ(u,x))))),
SetDelayed(SmartTrigExpand(Power(u_,n_),$p(x,SymbolHead)),
    Condition(Module(List(Set($s("tmp"),SmartTrigExpand(u,x))),Condition(Expand(Power($s("tmp"),n),x),SumQ($s("tmp")))),And(And(NonsumQ(u),IntIntegerQ(n)),Greater(n,C1)))),
SetDelayed(SmartTrigExpand(Times(u_,v_),$p(x,SymbolHead)),
    Condition(Module(List(Set($s("tmp1"),SmartTrigExpand(u,x)),Set($s("tmp2"),SmartTrigExpand(v,x))),Condition(Distribute(Times($s("tmp1"),$s("tmp2"))),Or(SumQ($s("tmp1")),SumQ($s("tmp2"))))),And(NonsumQ(u),NonsumQ(v)))),
SetDelayed(SmartTrigExpand(u_,$p(x,SymbolHead)),
    u),
SetDelayed(Simp($p("expn")),
    If(AtomQ($s("expn")),$s("expn"),If(Or(Or(SameQ(Head($s("expn")),$s("If")),SameQ(Head($s("expn")),$s("Int"))),SameQ(Head($s("expn")),$s("Dif"))),$s("expn"),SimpAux(Map($s("Integrate::Simp"),$s("expn")))))),
SetDelayed(SimpAux($p("expn")),
    Condition(Module(List(Set($s("tmp"),ContentFactor($s("expn"))),$s("lst"),Set(i,C1),j),If(UnsameQ($s("tmp"),$s("expn")),CompoundExpression(Set($s("tmp"),Simp($s("tmp"))),If(ProductQ($s("tmp")),ContentFactor($s("tmp")),$s("tmp"))),CompoundExpression(CompoundExpression(CompoundExpression(CompoundExpression(CompoundExpression(Set($s("lst"),Apply($s("List"),$s("expn"))),If(And(And(And(And(And(And(And(And(GreaterEqual(Length($s("lst")),C4),RationalQ(Part($s("lst"),C1))),PowerQ(Part($s("lst"),C2))),RationalQ(Part($s("lst"),C2,C1))),RationalQ(Part($s("lst"),C2,C2))),SqrtNumberSumQ(Part($s("lst"),C3))),PowerQ(Part($s("lst"),C4))),SqrtNumberSumQ(Part($s("lst"),C4,C1))),RationalQ(Part($s("lst"),C4,C2))),Set($s("lst"),Join(List(Part($s("lst"),C3),Part($s("lst"),C4),Part($s("lst"),C1),Part($s("lst"),C2)),Drop($s("lst"),C4))))),If(And(And(And(And(And(And(And(GreaterEqual(Length($s("lst")),C3),PowerQ(Part($s("lst"),C1))),RationalQ(Part($s("lst"),C1,C1))),RationalQ(Part($s("lst"),C1,C2))),SqrtNumberSumQ(Part($s("lst"),C2))),PowerQ(Part($s("lst"),C3))),SqrtNumberSumQ(Part($s("lst"),C3,C1))),RationalQ(Part($s("lst"),C3,C2))),Set($s("lst"),Join(List(Part($s("lst"),C2),Part($s("lst"),C3),Part($s("lst"),C1)),Drop($s("lst"),C3))))),While(True,If(Equal(i,Length($s("lst"))),Break(),CompoundExpression(Set(j,Plus(i,C1)),While(True,If(Greater(j,Length($s("lst"))),CompoundExpression(Increment(i),Break()),CompoundExpression(Set($s("tmp"),SimpProduct(Part($s("lst"),i),Part($s("lst"),j))),If(UnsameQ($s("tmp"),Times(Part($s("lst"),i),Part($s("lst"),j))),If(ProductQ($s("tmp")),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),First($s("tmp"))),Set(Part($s("lst"),j),Rest($s("tmp")))),Break()),CompoundExpression(CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),$s("tmp")),Set($s("lst"),Delete($s("lst"),j))),Set(i,C1)),Break())),CompoundExpression(Set($s("tmp"),SimpProduct(Part($s("lst"),j),Part($s("lst"),i))),If(UnsameQ($s("tmp"),Times(Part($s("lst"),j),Part($s("lst"),i))),If(ProductQ($s("tmp")),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),First($s("tmp"))),Set(Part($s("lst"),j),Rest($s("tmp")))),Break()),CompoundExpression(CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),$s("tmp")),Set($s("lst"),Delete($s("lst"),j))),Set(i,C1)),Break())),Increment(j))))))))))),Set($s("tmp"),Apply($s("Times"),$s("lst")))),If(ProductQ($s("tmp")),ContentFactor($s("tmp")),$s("tmp"))))),ProductQ($s("expn")))),
SetDelayed(SimpAux($p("expn")),
    Condition(Module(List(Set($s("lst"),Apply($s("List"),$s("expn"))),Set(i,C1),j,$s("tmp")),CompoundExpression(While(True,If(Equal(i,Length($s("lst"))),Break(),CompoundExpression(Set(j,Plus(i,C1)),While(True,If(Greater(j,Length($s("lst"))),CompoundExpression(Increment(i),Break()),CompoundExpression(Set($s("tmp"),SimpSum(Part($s("lst"),i),Part($s("lst"),j))),If(UnsameQ($s("tmp"),Plus(Part($s("lst"),i),Part($s("lst"),j))),If(SumQ($s("tmp")),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),First($s("tmp"))),Set(Part($s("lst"),j),Rest($s("tmp")))),Break()),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),$s("tmp")),Set($s("lst"),Delete($s("lst"),j))),Break())),CompoundExpression(Set($s("tmp"),SimpSum(Part($s("lst"),j),Part($s("lst"),i))),If(UnsameQ($s("tmp"),Plus(Part($s("lst"),j),Part($s("lst"),i))),If(SumQ($s("tmp")),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),First($s("tmp"))),Set(Part($s("lst"),j),Rest($s("tmp")))),Break()),CompoundExpression(CompoundExpression(Set(Part($s("lst"),i),$s("tmp")),Set($s("lst"),Delete($s("lst"),j))),Break())),Increment(j)))))))))),Apply($s("Plus"),$s("lst")))),SumQ($s("expn")))),
SetDelayed(SimpAux(Power(Plus(a_,b_),m_)),
    Condition(SimpAux(Power(Plus(Times(a,Power(Plus(Power(a,C2),Times(CN1,Power(b,C2))),CN1)),Times(CN1,Times(b,Power(Plus(Power(a,C2),Times(CN1,Power(b,C2))),CN1)))),Times(CN1,m))),And(And(And(IntIntegerQ(m),Less(m,C0)),SqrtNumberQ(a)),SqrtNumberQ(b)))),
SetDelayed(SimpAux(Power(u_,m_)),
    Condition(Expand(Power(u,m)),And(And(IntIntegerQ(m),Greater(m,C0)),SqrtNumberSumQ(u)))),
SetDelayed(SimpAux(Power(u_,m_)),
    Condition(Times(Power(CN1,m),SimpAux(Power(Times(CN1,u),m))),And(And(FractionQ(m),SqrtNumberSumQ(u)),NegativeQ(u)))),
SetDelayed(SimpAux(Power(u_,m_)),
    Condition(SimpAux(Power(Expand(Power(u,Denominator(Times(C1,Power(m,CN1))))),Times(C1,Power(Numerator(Times(C1,Power(m,CN1))),CN1)))),And(And(And(FractionQ(m),Greater(Denominator(Times(C1,Power(m,CN1))),C1)),SqrtNumberSumQ(u)),PositiveQ(u)))),
SetDelayed(SimpAux(Power(Plus(a_,b_),m_)),
    Condition(Module(List(Set($s("tmp"),CommonNumericFactors(List(a,b)))),CompoundExpression(Set($s("tmp"),Abs(NumericFactor(Power(Part($s("tmp"),C1),Times(C1,Power(Denominator(m),CN1)))))),Condition(Times(Power($s("tmp"),Numerator(m)),SimpAux(Power(Plus(Times(a,Power(Power($s("tmp"),Denominator(m)),CN1)),Times(b,Power(Power($s("tmp"),Denominator(m)),CN1))),m))),Unequal($s("tmp"),C1)))),And(And(And(FractionQ(m),Equal(Denominator(Times(C1,Power(m,CN1))),C1)),SqrtNumberQ(a)),SqrtNumberQ(b)))),
SetDelayed(SimpAux(Power(Plus(a_,b_),m_)),
    Condition(Module(List(Set($s("tmp1"),Abs(Numerator(NumericFactor(Power(Plus(Power(a,C2),Times(CN1,Power(b,C2))),Times(C1,Power(Denominator(m),CN1))))))),$s("tmp2")),CompoundExpression(Set($s("tmp2"),Times(Plus(Power(a,C2),Times(CN1,Power(b,C2))),Power(Power($s("tmp1"),Denominator(m)),CN1))),Condition(Times(Power($s("tmp1"),Numerator(m)),SimpAux(Power(Plus(Times(a,Power($s("tmp2"),CN1)),Times(CN1,Times(b,Power($s("tmp2"),CN1)))),Times(CN1,m)))),And(And(IntIntegerQ(Times(Power(a,C2),Power(Power($s("tmp2"),C2),CN1))),IntIntegerQ(Times(Power(b,C2),Power(Power($s("tmp2"),C2),CN1)))),Or(And(Equal(Power($s("tmp2"),C2),C1),Less(m,C0)),Greater(Power($s("tmp2"),C2),C1)))))),And(And(And(And(And(And(FractionQ(m),Equal(Denominator(Times(C1,Power(m,CN1))),C1)),SqrtNumberQ(a)),SqrtNumberQ(b)),PositiveQ(Plus(Power(a,C2),Times(CN1,Power(b,C2))))),IntIntegerQ(Power(a,C2))),IntIntegerQ(Power(b,C2))))),
SetDelayed(SimpAux(Power(Times(Plus(a_,b_),c_),m_)),
    Condition(SimpAux(Power(Plus(Times(c,a),Times(c,b)),m)),And(And(And(FractionQ(m),SqrtNumberQ(a)),SqrtNumberQ(b)),SqrtNumberQ(c)))),
SetDelayed(SimpAux(Power(Plus(a_,b_),m_)),
    Condition(Module(List(Set(q,Sqrt(Plus(Power(a,C2),Times(CN1,Power(b,C2)))))),Condition(SimpAux(Power(Plus(Sqrt(Times(Plus(a,q),C1D2)),Sqrt(Times(Plus(a,Times(CN1,q)),C1D2))),Times(C2,m))),RationalQ(q))),And(And(And(And(And(EvenQ(Times(C1,Power(m,CN1))),RationalQ(a)),Greater(a,C0)),SqrtNumberQ(b)),PositiveQ(b)),PositiveQ(Plus(Power(a,C2),Times(CN1,Power(b,C2))))))),
SetDelayed(SimpAux(Power(Plus(a_,b_),m_)),
    Condition(Module(List(Set(q,Sqrt(Plus(Power(a,C2),Times(CN1,Power(b,C2)))))),Condition(SimpAux(Power(Plus(Sqrt(Times(Plus(a,q),C1D2)),Times(CN1,Sqrt(Times(Plus(a,Times(CN1,q)),C1D2)))),Times(C2,m))),RationalQ(q))),And(And(And(And(And(EvenQ(Times(C1,Power(m,CN1))),RationalQ(a)),Greater(a,C0)),SqrtNumberQ(b)),NegativeQ(b)),PositiveQ(Plus(Power(a,C2),Times(CN1,Power(b,C2))))))),
SetDelayed(SimpProduct(c_,Plus(a_,b_)),
    Condition(Plus(Times(c,a),Times(c,b)),And(And(SqrtNumberQ(a),SqrtNumberQ(b)),SqrtNumberQ(c)))),
SetDelayed(SimpProduct(c_,Power(u_,m_)),
    Condition(Times(CN1,SimpProduct(Times(CN1,c),Power(u,m))),And(And(And(RationalQ(m),SqrtNumberSumQ(u)),SqrtNumberQ(c)),NegativeQ(c)))),
SetDelayed(SimpProduct(Power(u_,m_),Power(v_,n_)),
    Condition(Times(Power(CN1,m),SimpProduct(Power(Times(CN1,u),m),Power(v,n))),And(And(And(RationalQ(List(m,n)),SqrtNumberSumQ(u)),SqrtNumberSumQ(v)),NegativeQ(u)))),
SetDelayed(SimpProduct(c_,Power(Plus(a_,b_),m_)),
    Condition(SimpAux(Power(Plus(Times(a,Power(c,Times(C1,Power(m,CN1)))),Times(b,Power(c,Times(C1,Power(m,CN1))))),m)),And(And(And(And(And(RationalQ(m),SqrtNumberQ(a)),SqrtNumberQ(b)),SqrtNumberQ(Power(c,Times(C1,Power(m,CN1))))),PositiveQ(c)),Not(RationalQ(c))))),
SetDelayed(SimpProduct(Power(u_,m_),v_),
    Condition(Module(List(Set($s("gcd"),GCD(m,C1)),w),CompoundExpression(Set(w,Expand(Times(Power(u,Times(m,Power($s("gcd"),CN1))),Power(Times(CN1,v),Times(C1,Power($s("gcd"),CN1)))))),Condition(Times(CN1,SimpAux(Power(w,$s("gcd")))),Or(SqrtNumberQ(w),SqrtNumberSumQ(NonnumericFactors(w)))))),And(And(And(And(And(RationalQ(m),Greater(m,C0)),SqrtNumberSumQ(u)),SqrtNumberSumQ(v)),PositiveQ(u)),NegativeQ(v)))),
SetDelayed(SimpProduct(Power(u_,m_),v_),
    Condition(Module(List(Set($s("gcd"),GCD(m,C1)),w),CompoundExpression(Set(w,Simp(Times(Power(u,Times(m,Power($s("gcd"),CN1))),Power(Times(CN1,v),Times(C1,Power($s("gcd"),CN1)))))),Condition(Times(CN1,SimpAux(Power(w,$s("gcd")))),Or(SqrtNumberQ(w),SqrtNumberSumQ(NonnumericFactors(w)))))),And(And(And(And(And(RationalQ(m),Less(m,C0)),SqrtNumberSumQ(u)),SqrtNumberSumQ(v)),PositiveQ(u)),NegativeQ(v)))),
SetDelayed(SimpProduct(Power(u_,$p(m,true)),Power(v_,$p(n,true))),
    Condition(Module(List(Set($s("gcd"),GCD(m,n)),w),CompoundExpression(Set(w,Expand(Times(Power(u,Times(m,Power($s("gcd"),CN1))),Power(v,Times(n,Power($s("gcd"),CN1)))))),Condition(SimpAux(Power(w,$s("gcd"))),Or(SqrtNumberQ(w),SqrtNumberSumQ(w))))),And(And(And(And(And(And(RationalQ(List(m,n)),Greater(m,C0)),Greater(n,C0)),SqrtNumberSumQ(u)),SqrtNumberSumQ(v)),PositiveQ(u)),PositiveQ(v)))),
SetDelayed(SimpProduct(Power(u_,m_),Power(v_,$p(n,true))),
    Condition(Module(List(Set($s("gcd"),GCD(m,n)),w),CompoundExpression(Set(w,Simp(Times(Power(u,Times(m,Power($s("gcd"),CN1))),Power(v,Times(n,Power($s("gcd"),CN1)))))),Condition(SimpAux(Power(w,$s("gcd"))),Or(SqrtNumberQ(w),SqrtNumberSumQ(w))))),And(And(And(And(And(And(RationalQ(List(m,n)),Less(m,C0)),Greater(n,C0)),SqrtNumberSumQ(u)),SqrtNumberSumQ(v)),PositiveQ(u)),PositiveQ(v)))),
SetDelayed(SimpAux(Power(u_,n_)),
    Condition(Times(Power(CN1,n),SimpAux(Power(Map($s("Minus"),u),n))),And(And(SumQ(u),IntIntegerQ(n)),Less(NumericFactor(Part(u,C1)),C0)))),
SetDelayed(SimpProduct(u_,v_),
    Condition(Times(CN1,SimpAux(Times(Map($s("Minus"),u),v))),And(And(SumQ(u),Less(NumericFactor(Part(u,C1)),C0)),Not(And(SqrtNumberSumQ(u),SqrtNumberSumQ(v)))))),
SetDelayed(SimpAux(Power(u_,n_)),
    Condition(Module(List(Set($s("lst"),CommonFactors(Apply($s("List"),u)))),Condition(Times(Simp(Power(Part($s("lst"),C1),n)),SimpAux(Power(Apply($s("Plus"),Rest($s("lst"))),n))),UnsameQ(Part($s("lst"),C1),C1))),And(SumQ(u),IntIntegerQ(n)))),
SetDelayed(SimpAux(Power(u_,n_)),
    Condition(Module(List(Set($s("lst"),CommonNumericFactors(Apply($s("List"),u)))),Condition(Times(Power(Part($s("lst"),C1),n),SimpAux(Power(Apply($s("Plus"),Rest($s("lst"))),n))),UnsameQ(Part($s("lst"),C1),C1))),And(And(SumQ(u),Not(IntIntegerQ(n))),Not(SqrtNumberSumQ(u))))),
SetDelayed(SimpProduct(Power(Plus(a_,b_),m_),Power(Plus(c_,d_),$p(n,true))),
    Condition(Simp(Times(Power(Plus(a,b),Plus(m,n)),Power(Times(d,Power(b,CN1)),n))),And(And(IntIntegerQ(n),ZeroQ(Plus(Times(a,d),Times(CN1,Times(b,c))))),Not(SqrtNumberSumQ(Plus(a,b)))))),
SetDelayed(SimpProduct(Power(u_,$p(m,true)),Power(v_,$p(n,true))),
    Condition(Times(Power(CN1,n),Power(u,Plus(m,n))),And(And(And(IntIntegerQ(n),ZeroQ(Plus(u,v))),Not(RationalQ(u))),Or(Not(IntIntegerQ(m)),LessEqual(SmartLeafCount(u),SmartLeafCount(v)))))),
SetDelayed(SimpProduct(Power(Plus(a_,b_),$p(n,true)),Power(Plus(c_,d_),$p(n,true))),
    Condition(Simp(Power(Plus(Power(a,C2),Times(CN1,Power(b,C2))),n)),And(And(ZeroQ(Plus(a,Times(CN1,c))),ZeroQ(Plus(b,d))),IntIntegerQ(n)))),
SetDelayed(SimpSum(Times(Power(u_,CN1),a_),Times(Power(u_,CN1),b_)),
    Condition(C1,SameQ(Plus(a,b),u))),
SetDelayed(SimpSum(a_,Times(Power(Plus(c_,d_),C2),$p(b,true))),
    Condition(Simp(Times(Times(b,d),Plus(Times(C2,c),d))),ZeroQ(Plus(a,Times(b,Power(c,C2)))))),
SetDelayed(SimpSum(a_,Times(Plus($p(c,true),d_),Power(Plus(e_,f_),CN1),$p(b,true))),
    Condition(SimpAux(Times(ContentFactor(Plus(Times(a,e),Times(b,c))),Power(Plus(e,f),CN1))),And(And(And(And(And(And(NonsumQ(a),NonsumQ(b)),NonsumQ(c)),NonsumQ(d)),NonsumQ(e)),NonsumQ(f)),ZeroQ(Plus(Times(a,f),Times(b,d)))))),
SetDelayed(SimpProduct(Power(v_,$p(m,true)),Power(Plus(Times(Power(v_,n_),$p(b,true)),a_),$p(p,true))),
    Condition(SimpAux(Times(Power(v,Plus(m,Times(n,p))),Simp(Power(Plus(Times(a,Power(v,Times(CN1,n))),b),p)))),And(And(And(IntIntegerQ(p),RationalQ(List(m,n))),Less(n,C0)),Not(SqrtNumberSumQ(Plus(a,Times(b,Power(v,n)))))))),
SetDelayed(SimpProduct(Power(c_,$p(m,true)),Power(Plus(Times(Power(c_,$p(p,true)),$p(a,true)),Times(Power(c_,$p(q,true)),$p(b,true))),$p(n,true))),
    Condition(SimpAux(Power(Plus(Times(a,Power(c,Plus(p,Times(m,Power(n,CN1))))),Times(b,Power(c,Plus(q,Times(m,Power(n,CN1)))))),n)),And(IntIntegerQ(n),RationalQ(List(m,p,q))))),
SetDelayed(SimpSum(Times(Power(n_,CN1D2),$p(u,true)),Times(Power(n_,C1D2),$p(v,true))),
    Condition(Times(Plus(C1,Times(n,Times(NumericFactor(v),Power(NumericFactor(u),CN1)))),Times(u,Power(Sqrt(n),CN1))),And(RationalQ(n),SameQ(NonnumericFactors(u),NonnumericFactors(v))))),
SetDelayed(SimpSum(u_,Times(Plus(a_,b_),v_)),
    Condition(Module(List(Set($s("tmp"),SimpAux(Times(v,a)))),Condition(SimpAux(Plus(Times(Plus(C1,Times(NumericFactor($s("tmp")),Power(NumericFactor(u),CN1))),u),SimpAux(Times(v,b)))),SameQ(NonnumericFactors($s("tmp")),NonnumericFactors(u)))),And(And(NonsumQ(a),NonsumQ(u)),NonsumQ(v)))),
SetDelayed(SimpSum(Times(Plus(a_,b_),$p(u,true)),Times(Plus(c_,d_),v_)),
    Condition(Module(List(Set($s("tmp1"),SimpAux(Times(v,c))),Set($s("tmp2"),SimpAux(Times(u,a)))),Condition(CompoundExpression(Set($s("tmp1"),Times(NumericFactor($s("tmp1")),Power(NumericFactor($s("tmp2")),CN1))),If(Or(IntIntegerQ($s("tmp1")),Less(Less(integer(-2L),$s("tmp1")),C0)),SimpAux(Plus(Times(u,Plus(Times(Plus(C1,$s("tmp1")),a),b)),SimpAux(Times(v,d)))),SimpAux(Plus(SimpAux(Times(u,b)),Times(v,Plus(Times(Plus(C1,Times(C1,Power($s("tmp1"),CN1))),c),d)))))),SameQ(NonnumericFactors($s("tmp1")),NonnumericFactors($s("tmp2"))))),And(And(And(NonsumQ(a),NonsumQ(c)),NonsumQ(u)),NonsumQ(v)))),
SetDelayed(SimpAux(Power(E,Times(Plus(Times(Log(v_),$p(a,true)),b_),$p(c,true)))),
    Times(SimpAux(Power(v,Times(a,c))),SimpAux(Power(E,Times(b,c))))),
SetDelayed(SimpAux(Power(E,Times(ArcTanh(v_),n_))),
    Condition(Simp(Power(Plus(CN1,Times(C2,Power(Plus(C1,Times(CN1,v)),CN1))),Times(n,C1D2))),EvenQ(n))),
SetDelayed(SimpProduct(Power(E,Times(ArcTanh(v_),$p(n,true))),Power(Plus(C1,w_),m_)),
    Condition(Simp(Times(Power(Plus(C1,Times(CN1,v)),Plus(m,Times(CN1,Times(n,C1D2)))),Power(Plus(C1,v),Plus(m,Times(n,C1D2))))),And(And(OddQ(n),HalfIntegerQ(m)),ZeroQ(Plus(Power(v,C2),w))))),
SetDelayed(SimpAux(Power(E,Times(ArcCoth(v_),n_))),
    Condition(Simp(Power(Plus(C1,Times(CN1,Times(C2,Power(Plus(C1,Times(CN1,v)),CN1)))),Times(n,C1D2))),EvenQ(n))),
SetDelayed(SimpProduct(Power(E,Times(ArcCoth(v_),$p(n,true))),Power(Plus(C1,w_),m_)),
    Condition(Simp(Times(Power(Plus(CN1,v),Plus(m,Times(CN1,Times(n,C1D2)))),Times(Power(Plus(C1,v),Plus(m,Times(n,C1D2))),Power(Power(v,Times(C2,m)),CN1)))),And(And(OddQ(n),HalfIntegerQ(m)),ZeroQ(Plus(Power(v,C2),Times(C1,Power(w,CN1))))))),
SetDelayed(SimpAux(Power(E,Times(ProductLog(v_),$p(n,true)))),
    Condition(Simp(Times(Power(v,n),Power(Power(ProductLog(v),n),CN1))),And(IntIntegerQ(n),Greater(n,C0)))),
SetDelayed(SimpSum(Times(Power(Cos(z_),C2),$p(u,true)),Times(Power(Sin(z_),C2),$p(v,true))),
    Condition(u,SameQ(u,v))),
SetDelayed(SimpSum(Times(Power(Sec(z_),C2),$p(u,true)),Times(Power(Tan(z_),C2),$p(v,true))),
    Condition(u,SameQ(u,Times(CN1,v)))),
SetDelayed(SimpSum(Times(Power(Csc(z_),C2),$p(u,true)),Times(Power(Cot(z_),C2),$p(v,true))),
    Condition(u,SameQ(u,Times(CN1,v)))),
SetDelayed(SimpSum(u_,Times(Power(Sin(z_),C2),$p(v,true))),
    Condition(Times(u,Power(Cos(z),C2)),SameQ(u,Times(CN1,v)))),
SetDelayed(SimpSum(u_,Times(Power(Cos(z_),C2),$p(v,true))),
    Condition(Times(u,Power(Sin(z),C2)),SameQ(u,Times(CN1,v)))),
SetDelayed(SimpSum(u_,Times(Power(Tan(z_),C2),$p(v,true))),
    Condition(Times(u,Power(Sec(z),C2)),SameQ(u,v))),
SetDelayed(SimpSum(u_,Times(Power(Cot(z_),C2),$p(v,true))),
    Condition(Times(u,Power(Csc(z),C2)),SameQ(u,v)))
  );
}
